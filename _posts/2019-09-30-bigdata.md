---
layout: post
categories: posts
title: "[MSIS405.K11.CTTT] Big Data: GraphX and Neo4j Practice"
tags: [daily brief, Big Data, Spark, Graph, pandas]
date-string: SEPTEMBER 30, 2019
featured-image: /images/graphx.png
subtitle: An example based on Igor Bobriakov's tutorial.
---

## Tutorial
[Practical Apache Spark in 10 minutes. Part 7 â€” GraphX and Neo4j](https://medium.com/data-science-school/practical-apache-spark-in-10-minutes-part-7-graphx-and-neo4j-b6b01cffa4fd){:target="_blank"}
## Practice
- Because I had not install Hadoop and Spark, I installed them following <a style="color:blue;" href="https://medium.com/data-science-school/practical-apache-spark-in-10-minutes-part-1-ubuntu-installation-f69bbb17ee9d" target="_blank">this</a>
1. **Install Java**<br>
<img src="/images/2019-09-30/java_version.png">
1. **Install Hadoop**<br>
Hadoop port:<br>
<a href="https://stackoverflow.com/questions/22855232/default-namenode-port-of-hdfs-is-50070-but-i-have-come-across-at-some-places-802" target="_blank">
<img src="/images/2019-09-30/hadoop_port.png">
</a>
Result:
<img src="/images/2019-09-30/hadoop_test.png">
1. **Install Spark**<br>
<img src="/images/2019-09-30/spark_res.png"><br>

<a/>
- Back to the tutortial:
1. **Prepare the data using pandas**:
``` python
import pandas
edges = pandas.read_csv("copperfield_edges.csv")
nodes = pandas.read_csv("copperfield_nodes.csv")
print("nodes: ")
print(nodes)
print()
print("edges: ")
print(edges)
print()
from_tab = pandas.merge(nodes,edges,left_on='name',right_on='from')[['part_of_speech','from','to']]
print("from_tab: ")
print(from_tab)
to_tab = pandas.merge(nodes,edges, left_on='name',right_on='to')[['part_of_speech','to','from']]
print("to_tab: ")
print(to_tab)
print()
from_tab.rename(columns = {"part_of_speech": "pos_from"}, inplace = True)
to_tab.rename(columns = {"part_of_speech": "pos_to" }, inplace = True)
tab = pandas.merge(from_tab, to_tab, on=["to","from"])[["pos_from","from","pos_to","to"]]
print("tab table: ")
print(tab)
```
**Result:**<br>
<img src="/images/2019-09-30/node_edge.png"/>
<img src="/images/2019-09-30/tab_table.png"/>
<br>
**Explaination:**
        * **pandas.DataFrame**: Two-dimensional size-mutable, potentially heterogeneous tabular data structure with labeled axes (rows and columns). Arithmetic operations align on both row and column labels. Can be thought of as a dict-like container for Series objects. The primary pandas data structure.
        [**_Visit document's site_**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html){:target="_blank"}<br>
            *Example*:<br>
            . Constructing DataFrame from a dictionary:<br>
```python
>>> d = {'col1': [1, 2], 'col2': [3, 4]}
>>> df = pd.DataFrame(data=d)
>>> df
```
            <pre style="background-color:grey; display:inline-block">
                col1    col2
            0       1       3
            1       2       4       
            </pre>

            . Constructing DataFrame from numpy ndarray:
```python
>>> df = pd.DataFrame(np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]]), columns=['a', 'b', 'c'])
>>> df
```

            <pre style="background-color:grey; display:inline-block">
               a  b  c  
            0  1  2  3  
            1  4  5  6  
            2  7  8  9  
            </pre>
        * **pandas.read_csv()**: Read data from csv file to DataFrame. [**_Visit document's site_**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html){:target="_blank"}